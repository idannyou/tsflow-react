(this["webpackJsonptsflow-react"]=this["webpackJsonptsflow-react"]||[]).push([[0],{16:function(e,t,a){e.exports=a(37)},21:function(e,t,a){},31:function(e,t){},32:function(e,t){},33:function(e,t){},34:function(e,t){},35:function(e,t){},36:function(e,t){},37:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(11),c=a.n(s),o=(a(21),a(6)),u=a(2);function i(e){return r.a.createElement(u.Box,{margin:"lg",style:{width:"300px"}},e.children)}var l=function(e){var t=Boolean(!(e.appState.classOne&&e.appState.classTwo));return r.a.createElement(u.Flex,{alignItems:"center",justifyContent:"center",direction:"column"},r.a.createElement(i,null,r.a.createElement(u.Header.H2,null,"Class One:"),r.a.createElement(u.Input,{placeholder:"Input your first class (ex: Wearing hat)",onChange:function(t){return e.appState.setClassOne(t.target.value)},value:e.appState.classOne})),r.a.createElement(i,null,r.a.createElement(u.Header.H2,null,"Class Two:"),r.a.createElement(u.Input,{placeholder:"Input your second class (ex: Not wearing hat)",onChange:function(t){return e.appState.setClassTwo(t.target.value)},value:e.appState.classTwo})),r.a.createElement(u.Box,{margin:"lg"},r.a.createElement(u.Button,{disabled:t,onClick:function(){return e.appState.setFinishInputClasses(!0)}},"Submit")))},p=a(3),f=a.n(p),m=a(5),d=a(4),h=a(7);function w(){return x.apply(this,arguments)}function x(){return(x=Object(m.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.c("https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_0.25_224/model.json");case 2:return t=e.sent,a=t.getLayer("conv_pw_13_relu"),e.abrupt("return",d.d({inputs:t.inputs,outputs:a.output}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return v.apply(this,arguments)}function v(){return(v=Object(m.a)(f.a.mark((function e(t){var a,n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,h.b(t);case 5:a=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error(e.t0);case 11:return e.next=13,w();case 13:return n=e.sent,e.next=16,a.capture();case 16:return r=e.sent,n.predict(r.expandDims(0)),r.dispose(),e.abrupt("return",{webcam:a,truncatedMobileNet:n});case 20:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function b(e){return E.apply(this,arguments)}function E(){return(E=Object(m.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.capture();case 2:return a=e.sent,n=d.i((function(){return a.expandDims(0).toFloat().div(127).sub(1)})),a.dispose(),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t){for(var a=t.getContext("2d"),n=new ImageData(224,224),r=e.dataSync(),s=0;s<50176;++s){var c=4*s;n.data[c+0]=127*(r[3*s+0]+1),n.data[c+1]=127*(r[3*s+1]+1),n.data[c+2]=127*(r[3*s+2]+1),n.data[c+3]=255}a.putImageData(n,0,0)}function y(e,t,a){return O.apply(this,arguments)}function O(){return(O=Object(m.a)(f.a.mark((function e(t,a,n){var r,s,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.xs){e.next=2;break}throw new Error("Add some examples before training!");case 2:if(r=d.g({layers:[d.b.flatten({inputShape:a.outputs[0].shape.slice(1)}),d.b.dense({units:100,activation:"relu",kernelInitializer:"varianceScaling",useBias:!0}),d.b.dense({units:2,kernelInitializer:"varianceScaling",useBias:!1,activation:"softmax"})]}),s=d.j.adam(1e-4),r.compile({optimizer:s,loss:"categoricalCrossentropy"}),(c=Math.floor(.4*t.xs.shape[0]))>0){e.next=8;break}throw new Error("Batch size is 0 or NaN. Please choose a non-zero fraction.");case 8:return e.next=10,r.fit(t.xs,t.ys,{batchSize:c,epochs:20,callbacks:{onBatchEnd:function(){var e=Object(m.a)(f.a.mark((function e(t,a){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n("Loss: "+a.loss.toFixed(5));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}});case 10:return e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,t,a){return C.apply(this,arguments)}function C(){return(C=Object(m.a)(f.a.mark((function e(t,a,n){var r,s,c,o,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(t.current);case 2:return r=e.sent,s=a.current.predict(r),c=n.current.predict(s),o=c.as1D().argMax(),e.next=8,o.data();case 8:return u=e.sent[0],r.dispose(),e.next=12,d.e();case 12:return e.abrupt("return",u);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=r.a.useState(!1),n=Object(o.a)(a,2),s=n[0],c=n[1];return r.a.useEffect((function(){var a;return s?a=setTimeout(e,t):clearTimeout(a),function(){clearTimeout(a)}}),[s,t,e]),{onMouseDown:function(){return c(!0)},onMouseUp:function(){return c(!1)},onMouseLeave:function(){return c(!1)},onTouchStart:function(){return c(!0)},onTouchEnd:function(){return c(!1)}}}function k(e){var t=j(Object(m.a)(f.a.mark((function t(){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b(e.appState.webcamRef.current);case 2:g(a=t.sent,e.appState.classOneCanvasRef.current),e.appState.setClassOneSamples(e.appState.classOneSamples+1),e.appState.controllerDatasetRef.current.addExample(e.appState.truncatedMobileNetRef.current.predict(a),0),a.dispose();case 7:case"end":return t.stop()}}),t)})))),a=j(Object(m.a)(f.a.mark((function t(){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b(e.appState.webcamRef.current);case 2:g(a=t.sent,e.appState.classTwoCanvasRef.current),e.appState.setClassTwoSamples(e.appState.classTwoSamples+1),e.appState.controllerDatasetRef.current.addExample(e.appState.truncatedMobileNetRef.current.predict(a),1),a.dispose();case 7:case"end":return t.stop()}}),t)})))),n=r.a.useState(!1),s=Object(o.a)(n,2),c=s[0],i=s[1],l=r.a.useState(0),p=Object(o.a)(l,2),d=p[0],h=p[1],w=r.a.useState(null),x=Object(o.a)(w,2),S=x[0],v=x[1],E=r.a.useState(!1),O=Object(o.a)(E,2),C=O[0],k=O[1],T=function(){var t=Object(m.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y(e.appState.controllerDatasetRef.current,e.appState.truncatedMobileNetRef.current,(function(e){return console.log(e)}));case 2:e.appState.modelRef.current=t.sent,i(!1),k(!0);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return r.a.useEffect((function(){var t;return c?t=setTimeout(Object(m.a)(f.a.mark((function t(){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R(e.appState.webcamRef,e.appState.truncatedMobileNetRef,e.appState.modelRef);case 2:a=t.sent,h(d+1),v(a);case 5:case"end":return t.stop()}}),t)}))),100):clearTimeout(t),function(){clearTimeout(t)}})),r.a.createElement(u.Box,{margin:"md"},r.a.createElement(u.Box,{margin:"md"},r.a.createElement(u.FlexList,{size:"lg",justifyContent:"center"},r.a.createElement(u.Button,{disabled:null==e.appState.controllerDatasetRef.current.xs,onClick:T,style:{width:"125px"}},"Train"),r.a.createElement(u.Button,{disabled:!C,onClick:function(){c&&v(null),i(!c)},style:{width:"125px"}},c?"Stop Predicting":"Predict"))),r.a.createElement(u.FlexList,{size:"lg",justifyContent:"center"},r.a.createElement(u.Flex,{direction:"column",alignItems:"center"},r.a.createElement(u.Header.H3,{style:{color:null===S?"black":0===S?"green":"red"}},e.appState.classOne),r.a.createElement(u.Button,Object.assign({style:{width:"125px"}},t),"Add Sample")),r.a.createElement(u.Flex,{direction:"column",alignItems:"center"},r.a.createElement(u.Header.H3,{style:{color:null===S?"black":1===S?"green":"red"}},e.appState.classTwo),r.a.createElement(u.Button,Object.assign({style:{width:"125px"}},a),"Add Sample"))))}function T(e){return r.a.createElement(u.FlexList,null,r.a.createElement(u.Box,{margin:"sm"},r.a.createElement(u.FlexList,{direction:"column"},r.a.createElement("canvas",{ref:e.appState.classOneCanvasRef,width:"224",height:"224",style:{width:"150px"}}),r.a.createElement(u.Font,null,"Samples: ".concat(e.appState.classOneSamples)))),r.a.createElement(u.Box,{margin:"sm"},r.a.createElement(u.FlexList,{direction:"column"},r.a.createElement("canvas",{ref:e.appState.classTwoCanvasRef,width:"224",height:"224",style:{width:"150px"}}),r.a.createElement(u.Font,null,"Samples: ".concat(e.appState.classTwoSamples)))))}var B=function(e){return r.a.useEffect((function(){function t(){return(t=Object(m.a)(f.a.mark((function t(){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S(e.appState.videoRef.current);case 2:a=t.sent,e.appState.webcamRef.current=a.webcam,e.appState.truncatedMobileNetRef.current=a.truncatedMobileNet;case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e.appState.webcamRef,e.appState.videoRef,e.appState.truncatedMobileNetRef]),r.a.createElement(u.Flex,{direction:"column",alignItems:"center"},r.a.createElement(u.Box,{margin:"md"},r.a.createElement(u.Card,null,r.a.createElement(u.Box,{margin:"md"},r.a.createElement("video",{ref:e.appState.videoRef,autoPlay:!0,playsInline:!0,muted:!0,width:"224",height:"224"})))),r.a.createElement(u.Card,null,r.a.createElement(k,e)),r.a.createElement(T,e))},I=a(14),F=a(15),M=function(){function e(t){Object(I.a)(this,e),this.numClasses=t}return Object(F.a)(e,[{key:"addExample",value:function(e,t){var a=this,n=d.i((function(){return d.f(d.h([t]).toInt(),a.numClasses)}));if(null==this.xs)this.xs=d.a(e),this.ys=d.a(n);else{var r=this.xs;this.xs=d.a(r.concat(e,0));var s=this.ys;this.ys=d.a(s.concat(n,0)),r.dispose(),s.dispose(),n.dispose()}}}]),e}();var N=function(){var e=function(){var e=r.a.useState(""),t=Object(o.a)(e,2),a=t[0],n=t[1],s=r.a.useState(""),c=Object(o.a)(s,2),u=c[0],i=c[1],l=r.a.useState(0),p=Object(o.a)(l,2),f=p[0],m=p[1],d=r.a.useState(0),h=Object(o.a)(d,2),w=h[0],x=h[1],S=r.a.useState(!1),v=Object(o.a)(S,2),b=v[0],E=v[1],g=r.a.useRef(),y=r.a.useRef(),O=r.a.useRef(),R=r.a.useRef(new M(2)),C=r.a.useRef;return{classOne:a,setClassOne:n,classTwo:u,setClassTwo:i,classOneSamples:f,setClassOneSamples:m,classTwoSamples:w,setClassTwoSamples:x,finishInputClasses:b,setFinishInputClasses:E,videoRef:g,truncatedMobileNetRef:y,webcamRef:O,classOneCanvasRef:r.a.useRef(),classTwoCanvasRef:r.a.useRef(),controllerDatasetRef:R,modelRef:C}}();return window.appState=e,r.a.createElement(u.Flex,{direction:"column",alignItems:"center"},r.a.createElement(u.Card,{style:{width:"370px",height:"600px"}},e.finishInputClasses?r.a.createElement(B,{appState:e}):r.a.createElement(l,{appState:e})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[16,1,2]]]);
//# sourceMappingURL=main.96f059ff.chunk.js.map